{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "gnu-assembly",
	"scopeName": "source.assembly",
	"fileTypes": ["asm", "s", "S"],
	"patterns": [
		{
			"include": "#comments"
		},
		{
			"include": "#strings"
		},
		{
			"include": "#directiveOperands"
		},
		{
			"include": "#callOperands"
		},
		{
			"include": "#directives"
		},
		{
			"include": "#labels"
		},
		{
			"include": "#instructions"
		},
		{
			"include": "#registers"
		},
		{
			"include": "#numbers"
		},
		{
			"include": "#immediates"
		},
		{
			"include": "#loosewords"
		}
	],
	"repository": {
		"comments": {
			"patterns": [
				{
					"name": "comment.line.assembly",
					"match": "#.*$"
				}
			]
		},
		"strings": {
			"name": "string.quoted.double.assembly",
			"begin": "\"",
			"end": "\"",
			"patterns": [
				{
					"name": "constant.character.escape.assembly",
					"match": "\\\\."
				}
			]
		},
		"directives": {
			"patterns": [
				{
					"name": "entity.name.gnu.directive.assembly",
					"match": "@[a-zA-Z_][a-zA-Z0-9_]*"
				},
				{
					"name": "entity.name.directive.assembly",
					"match": "\\.(section|text|data|bss|globl|global|extern|align|byte|word|long|quad|int|short|float|double|space|asciz|ascii|include)\\b"
				},
				{
					"name": "entity.name.directive.assembly",
					"match": "\\.[a-zA-Z_][a-zA-Z0-9_]*"
				}
			]
		},
		"labels": {
			"patterns": [
				{
					"name": "entity.name.label.assembly",
					"match": "^[A-Za-z_][A-Za-z0-9_]*:"
				},
				{
					"name": "entity.name.label.local.assembly",
					"match": "^\\.[A-Za-z_][A-Za-z0-9_]*:"
				}
			]
		},
		"instructions": {
			"patterns": [
				{
					"name": "keyword.instruction.assembly",
					"match": "\\b(mov|add|sub|mul|imul|div|idiv|call|jmp|je|jne|ja|jb|jbe|jae|jg|jl|jle|jge|jo|jno|js|jns|jz|jnz|ret|push|pop|xchg|lea|cmp|test|and|or|xor|not|shl|shr|sar|sal|rol|ror|inc|dec|neg|nop|int|iret|hlt|cli|sti|lgdt|lldt|ltr|lgs|lfs|lss|leave|enter|loop|loope|loopne|loopz|loopnz|jcxz|jecxz|cpuid|rdmsr|wrmsr)(?:[bwlq])?\\b"
				}
			]
		},
		"callOperands": {
			"patterns": [
				{
					"match": "(call|jmp|je|jne|ja|jb|jbe|jae|jg|jl|jle|jge|jo|jno|js|jns|jz|jnz|loop|loope|loopne|loopz|loopnz|jcxz|jecxz)\\s+([A-Za-z_][A-Za-z0-9_]*)",
					"captures": {
						"1": {
							"name": "keyword.instruction.assembly"
						},
						"2": {
							"name": "entity.name.label.assembly"
						}
					}
				}
			]
		},
		"directiveOperands": {
			"patterns": [
				{
					"match": "(\\.(globl|global|extern))\\s+([A-Za-z_][A-Za-z0-9_]*)",
					"captures": {
						"1": {
							"name": "entity.name.directive.assembly"
						},
						"2": {
							"name": "entity.name.directive.assembly"
						},
						"3": {
							"name": "entity.name.label.assembly"
						}
					}
				},
				{
					"match": "(\\.(type|size))\\s+([A-Za-z_][A-Za-z0-9_]*)",
					"captures": {
						"1": {
							"name": "entity.name.directive.assembly"
						},
						"2": {
							"name": "entity.name.directive.assembly"
						},
						"3": {
							"name": "entity.name.label.assembly"
						}
					}
				}
			]
		},
		"registers": {
			"patterns": [
				{
					"name": "variable.register.assembly",
					"match": "\\b(rax|rbx|rcx|rdx|rsi|rdi|rbp|rsp|r8|r9|r10|r11|r12|r13|r14|r15|eax|ebx|ecx|edx|esi|edi|ebp|esp|r8d|r9d|r10d|r11d|r12d|r13d|r14d|r15d|ax|bx|cx|dx|si|di|bp|sp|r8w|r9w|r10w|r11w|r12w|r13w|r14w|r15w|al|bl|cl|dl|sil|dil|bpl|spl|r8b|r9b|r10b|r11b|r12b|r13b|r14b|r15b|ah|bh|ch|dh|es|cs|ss|ds|fs|gs)\\b"
				},
				{
					"name": "variable.register.assembly",
					"match": "%[a-z0-9]+"
				}
			]
		},
		"numbers": {
			"patterns": [
				{
					"name": "constant.numeric.hex.assembly",
					"match": "0x[0-9A-Fa-f]+"
				},
				{
					"name": "constant.numeric.octal.assembly",
					"match": "0[0-7]+"
				},
				{
					"name": "constant.numeric.decimal.assembly",
					"match": "\\b\\d+\\b"
				}
			]
		},
		"immediates": {
			"patterns": [
				{
					"match": "(\\$)([A-Za-z_][A-Za-z0-9_]*)",
					"captures": {
						"1": {
							"name": "constant.numeric.immediate.assembly"
						},
						"2": {
							"name": "constant.numeric.immediate.operand.assembly"
						}
					}
				},
				{
					"name": "constant.numeric.immediate.assembly",
					"match": "\\$[0-9A-Fa-f]+"
				}
			]
		},
		"loosewords": {
			"patterns": [
				{
					"name": "variable.other.assembly",
					"match": "\\b[A-Za-z_][A-Za-z0-9_]*\\b"
				}
			]
		}
	}
}